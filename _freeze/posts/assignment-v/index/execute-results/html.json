{
  "hash": "35aa369a0bce4292765bc413d5faf3a1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Assignment 5: NHL Player Performance Analysis\"\nauthor: \"Justice Kessie\"\ndate: \"2025-03-24\"\ncategories: [news, code, analysis]\nimage: \"image.png\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load necessary libraries\nrequire(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: dplyr\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\nrequire(ggplot2)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: ggplot2\n```\n\n\n:::\n\n```{.r .cell-code}\nrequire(tidyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: tidyr\n```\n\n\n:::\n\n```{.r .cell-code}\nrequire(lubridate)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: lubridate\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'lubridate'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    date, intersect, setdiff, union\n```\n\n\n:::\n\n```{.r .cell-code}\nrequire(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: tidyverse\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ forcats 1.0.0     ✔ stringr 1.5.1\n✔ purrr   1.0.2     ✔ tibble  3.2.1\n✔ readr   2.1.5     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nrequire(readr)\n```\n:::\n\n\n\n## Hart Memorial Trophy Consideration: Identifying the Top-Performing NHL Players to their Respective Teams\n\nTo identify the top-performing NHL players for the Hart Memorial Trophy consideration, we need to analyze player performance based on key metrics such as goals, assists, points, and plus-minus rating. The following R code snippet demonstrates how to load and analyze NHL player data to identify the top-performing players based on these metrics.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the dataset\nnhl_lines <- read.csv(\"lines.csv\")\n```\n:::\n\n\n\n\n\nTo do this, we created key metrics such as net value, net value per 60 minutes, team share, and \"most valuable player\" (MVP) score to evaluate player performance. We then filtered the dataset to include only players with a sufficient number of games played and calculated the MVP score for each player based on these metrics.\n\nMVP Score measures the player's overall contribution to the team's success, considering their performance in key areas such as goals, assists, and time on ice. The formula for MVP Score is a combination of net value per 60 minutes, time on ice, and team contribution percentage. The higher the MVP Score, the more valuable the player is to their team.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Results\nprint(top5[, c(\"name\", \"team\", \"position\", \"mvp_score\", \"netValue_per60\", \"icetime\", \"team_share\")])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                   name team position mvp_score netValue_per60 icetime\n873     Ekholm-Bouchard  EDM  pairing 0.7051221     0.01650297   56099\n260        Slavin-Burns  CAR  pairing 0.5745015     0.01373800   59703\n587         Toews-Makar  COL  pairing 0.5134146     0.01251426   55233\n301 Gostisbehere-Walker  CAR  pairing 0.4464199     0.01812296   41086\n294     Orlov-Chatfield  CAR  pairing 0.4114806     0.01136221   55711\n    team_share\n873   18.03951\n260   17.11471\n587   17.45677\n301   12.15255\n294   15.34321\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Top 10 MVP scores\nggplot(head(hart_ballot, 10), aes(x=reorder(name, mvp_score), y=mvp_score, fill=team)) +\n  geom_bar(stat=\"identity\") +\n  coord_flip() +\n  labs(title=\"Hart Trophy Candidates: MVP Score\", x=\"Player\", y=\"MVP Score\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\nThe results shows that the pair Ekholm-Bouchard are the top-performing players based on the MVP score (0.705), followed by the triple Hyman-McDavid-Draisaitl for team Edmonton Oilers. The pairs Slavis-Burns, Gostisbehere-Walker, and Orlov-Chatfield also played an indispensable role in team CAR.\n\nMeanwhile the Hartman Memorial trophy goes to the pair Ekholm-Bouchard for their outstanding performance in the recent season.\n\n## Vezina Trophy Consideration: Identifying the Top-Performing NHL Goalies\n\nTo find the best goalies in the NHL, we need to analyze their performance based on key metrics such as save percentage and goals against average (GAA). The following R code snippet demonstrates how to load and analyze NHL goalie data to identify the top-performing goalies based on these metrics for the Vezina Trophy consideration.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the dataset\nshots_data <- read.csv(\"shots_2024.csv\")\n```\n:::\n\n\n\n\n\nWe summarize the goalie performance based on the number of shots faced, goals allowed, saves made, save percentage, and games played. We then calculate the goals against average (GAA) for each goalie to further evaluate their performance.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngoalie_stats <- shots_data %>%\n  filter(shotWasOnGoal == 1) %>%  # Only consider shots on goal\n  group_by(goalieNameForShot) %>%\n  summarise(\n    Shots_On_Goal = n(),\n    Goals_Allowed = sum(goal),\n    Saves = Shots_On_Goal - Goals_Allowed,\n    Save_Percentage = Saves / Shots_On_Goal,\n    Games_Played = n_distinct(game_id)\n  ) %>%\n  arrange(desc(Save_Percentage))\n\n# View top goalies\nhead(goalie_stats)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 6\n  goalieNameForShot Shots_On_Goal Goals_Allowed Saves Save_Percentage\n  <chr>                     <int>         <int> <int>           <dbl>\n1 Akira Schmid                 12             0    12           1    \n2 Nico Daws                    88             3    85           0.966\n3 Erik Portillo                29             1    28           0.966\n4 Marcus Hogberg              177            11   166           0.938\n5 Connor Hellebuyck          1395           102  1293           0.927\n6 Louis Domingue               27             2    25           0.926\n# ℹ 1 more variable: Games_Played <int>\n```\n\n\n:::\n:::\n\n\n\nNext, we calculate the goals against average (GAA) for each goalie by dividing the total goals allowed by the total games played. We then merge the two datasets to compare the goalies based on save percentage and GAA.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngoalie_gaa <- shots_data %>%\n  filter(shotWasOnGoal == 1) %>%\n  group_by(goalieNameForShot) %>%\n  summarise(\n    Goals_Allowed = sum(goal),\n    Games_Played = n_distinct(game_id),\n    GAA = (Goals_Allowed * 60) / (Games_Played * 60)  # Approximate per 60 minutes\n  ) %>%\n  arrange(GAA)\n\n# View best GAA goalies\nhead(goalie_gaa)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 4\n  goalieNameForShot Goals_Allowed Games_Played   GAA\n  <chr>                     <int>        <int> <dbl>\n1 \"Akira Schmid\"                0            1  0   \n2 \"Nico Daws\"                   3            4  0.75\n3 \"Erik Portillo\"               1            1  1   \n4 \"Yaniv Perets\"                1            1  1   \n5 \"\"                          418          395  1.06\n6 \"Marcus Hogberg\"             11            8  1.38\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Merge the two datasets and delete the duplicate colummns\ngoalie_performance <- merge(goalie_stats, goalie_gaa, by=\"goalieNameForShot\")\n\n# Rank by Save Percentage and GAA\ngoalie_performance <- goalie_performance %>%\n  arrange(desc(Save_Percentage), GAA)\n\n# View top-ranked goalies\nhead(goalie_performance)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  goalieNameForShot Shots_On_Goal Goals_Allowed.x Saves Save_Percentage\n1      Akira Schmid            12               0    12       1.0000000\n2         Nico Daws            88               3    85       0.9659091\n3     Erik Portillo            29               1    28       0.9655172\n4    Marcus Hogberg           177              11   166       0.9378531\n5 Connor Hellebuyck          1395             102  1293       0.9268817\n6    Louis Domingue            27               2    25       0.9259259\n  Games_Played.x Goals_Allowed.y Games_Played.y      GAA\n1              1               0              1 0.000000\n2              4               3              4 0.750000\n3              1               1              1 1.000000\n4              8              11              8 1.375000\n5             52             102             52 1.961538\n6              1               2              1 2.000000\n```\n\n\n:::\n:::\n\n\n\nTo filter out goalies who have faced a minimum number of shots and played a minimum number of games, we set thresholds for shots faced and games played. We then filter the dataset to include only goalies who meet these criteria. By the way, forgo the duplicate columns.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set a threshold for minimum shots faced\nmin_shots <- 1000\nmin_games_played <- 50\n\n# Filter goalies who faced at least 'min_shots'\ngoalie_performance_filtered <- goalie_performance %>%\n  filter(Shots_On_Goal >= min_shots & Games_Played.x >= min_games_played) %>%\n  arrange(desc(Save_Percentage), GAA)\n\n# View the updated rankings\nhead(goalie_performance_filtered)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     goalieNameForShot Shots_On_Goal Goals_Allowed.x Saves Save_Percentage\n1    Connor Hellebuyck          1395             102  1293       0.9268817\n2   Andrei Vasilevskiy          1454             117  1337       0.9195323\n3         Ilya Sorokin          1393             131  1262       0.9059584\n4      Igor Shesterkin          1410             133  1277       0.9056738\n5 Ukko-Pekka Luukkonen          1350             151  1199       0.8881481\n  Games_Played.x Goals_Allowed.y Games_Played.y      GAA\n1             52             102             52 1.961538\n2             53             117             53 2.207547\n3             50             131             50 2.620000\n4             50             133             50 2.660000\n5             50             151             50 3.020000\n```\n\n\n:::\n:::\n\n\n\nFinally, we create a scatter plot to visualize the relationship between save percentage and goals against average for the top-performing goalies. We use point size to represent the number of shots faced by each goalie. The plot provides a clear comparison of goalie performance based on these key metrics.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(goalie_performance_filtered, aes(x = Save_Percentage, y = GAA, label = goalieNameForShot, size = Shots_On_Goal)) +\n  geom_point(alpha = 0.8) +  # Semi-transparent points for better visualization\n  geom_text(vjust = -1, hjust = 0.5, size = 3.5, fontface = \"bold\") +  # Clearer labels\n  scale_size(range = c(3, 8)) +  # Adjust point sizes for better distinction\n  labs(\n    title = \"🏒 Goalie Performance: Save Percentage vs Goals Against Average\",\n    subtitle = paste(\"Minimum\", min_shots, \"shots faced required for inclusion\"),\n    x = \"Save Percentage (Higher is Better)\",\n    y = \"Goals Against Average (Lower is Better)\",\n    size = \"Shots Faced\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\nWe adjudge Connor Hellebuyck, Andrei Vasilevskiy, and Ilya Sorokin as the top-3-performing goalies based on save percentage, goals against average and games played, with Connor being the best goaltender for the Vezina Trophy.\n\n## James Norris Memorial Trophy Consideration: Identifying the \"Best All-Around\" Defenseman\n\nHere, we used the NHL Draft Stats dataset to identify the top defensemen based on key metrics such as points per game, assists per game, goals per game, offensive score, and defensive score. We then filtered the dataset to include only defensemen who played more than 50 games and ranked them based on their offensive and defensive scores.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the dataset\nNHLDraftStats <- read.csv(\"SkaterIndividualstats.csv\")\n```\n:::\n\n\n\n\n\nOffensive score is calculated as the sum of points per game, assists per game, and goals per game, while defensive score is calculated as the sum of shots blocked, hits, takeaways, and penalized by giveaways per game. We then rank the defensemen based on their offensive and defensive scores to identify the top performers.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter out defensemen\ndefensemen <- NHLDraftStats %>% filter(Position == \"D\")\n# Compute key metrics\ndefensemen <- defensemen %>%\n  mutate(\n    PPG = Total.Points / GP, # points per game\n    APG = Total.Assists / GP,# assists per game\n    GPG = Goals / GP,   # goals per game\n    Offensive.Score  = PPG + APG + GPG, # offensive score\n    Defensive.Score = (Shots.Blocked + Hits + Takeaways - Giveaways) / GP\n  )\n\n# Shortlisted to players who played more than 50 games\ndefensemen <- defensemen %>% filter(GP > 50)\n\n# Rank players based on Defensive Score PPG and total points\ntop_defensemen <- defensemen %>% \n  arrange(desc(Defensive.Score + Offensive.Score)) %>% \n  head(10)\n```\n:::\n\n\n\nHere is a visualization of the top 5 defensemen based on their total points, combining offensive and defensive scores. The bar chart provides a clear comparison of the top defensemen based on their overall performance.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Bar chart of total points\nggplot(top_defensemen, aes(x = reorder(Player, -(Defensive.Score * Offensive.Score)), y = Defensive.Score * Offensive.Score, fill = Player)) +\n  geom_bar(stat = 'identity') +\n  labs(title = 'Top 5 Defensemen - Total Points', x = 'Player', y = 'Total Points') +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\nWe ranked Moritz Seider, MacKenzie Weegar, Cale Makar, Colton Parayko and Neal Pionk as the top 5 defensemen based on their overall performance. Moritz Seider is the best defenseman for the James Norris Memorial Trophy.\n\n## Calder Memorial Trophy Consideration: Identifying the Top Rookie Performer\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the dataset\nrookie_stats <- read.csv(\"RookieSkaterIndividual.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# View the first few rows\ncolnames(rookie_stats)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"X\"                \"Player\"           \"Team\"             \"Position\"        \n [5] \"GP\"               \"TOI\"              \"Goals\"            \"Total.Assists\"   \n [9] \"First.Assists\"    \"Second.Assists\"   \"Total.Points\"     \"IPP\"             \n[13] \"Shots\"            \"SH.\"              \"ixG\"              \"iCF\"             \n[17] \"iFF\"              \"iSCF\"             \"iHDCF\"            \"Rush.Attempts\"   \n[21] \"Rebounds.Created\" \"PIM\"              \"Total.Penalties\"  \"Minor\"           \n[25] \"Major\"            \"Misconduct\"       \"Penalties.Drawn\"  \"Giveaways\"       \n[29] \"Takeaways\"        \"Hits\"             \"Hits.Taken\"       \"Shots.Blocked\"   \n[33] \"Faceoffs.Won\"     \"Faceoffs.Lost\"    \"Faceoffs..\"      \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Compute key metrics\nrookies <- rookie_stats %>%\n  mutate(\n    PPG = Total.Points / GP,\n    APG = Total.Assists / GP,\n    GPG = Goals / GP,\n    Rookie.Score = (Total.Points + (Takeaways - Giveaways) + Shots + Hits) / GP,\n    PPGRS = PPG * Rookie.Score # combined metric of PPG and Rookie Score\n  )\n\n# Rank players based on overall Rookie Score\ntop_rookies <- rookies %>% \n  arrange(desc(Rookie.Score)) %>% \n  head(10)\n\n# Ensure PPG is not missing or NA\ntop_rookies <- top_rookies %>% filter(!is.na(PPG))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(top_rookies, aes(x = reorder(Player, -PPGRS))) +\n  geom_bar(aes(y = PPGRS, fill = Player), stat = 'identity', alpha = 0.7) +\n  geom_line(aes(y = PPG * max(Rookie.Score, na.rm = TRUE) / max(PPG, na.rm = TRUE), group = 1), \n            color = 'blue', linewidth = 1) +\n  geom_point(aes(y = PPG * max(Rookie.Score, na.rm = TRUE) / max(PPG, na.rm = TRUE)), \n             color = 'blue', size = 3) +\n  scale_y_continuous(\n    name = 'Rookie Score', \n    sec.axis = sec_axis(~ . * max(top_rookies$PPG, na.rm = TRUE) / max(top_rookies$Rookie.Score, na.rm = TRUE), \n                        name = 'PPG')\n  ) +\n  labs(title = 'Top 5 Rookies - Rookie Score & PPG', x = 'Player') +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n\n## Frank J. Selke Trophy Consideration: Identifying the Best Defensive Forward\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Using the previous dataset\n# Filtering for forwards and calculating Selke Score\nforwards <- rookie_stats %>%\n  filter(Position != \"D\" & GP >= 50) %>%  \n  mutate(\n    Takeaway_Ratio = Takeaways / (Takeaways + Giveaways),\n    Blocked_Shot_Rate = Shots.Blocked / TOI * 60,\n    Faceoff_Effectiveness = ifelse(Faceoffs.Won + Faceoffs.Lost > 0, \n                                  Faceoffs.Won / (Faceoffs.Won + Faceoffs.Lost), 0),\n    Penalty_Discipline = 1 - (PIM / (TOI/60)),\n    \n    # Combine into Selke Score\n    Selke_Score = (\n      (Takeaway_Ratio * 2.5) +          # Takeaways and giveaways\n      (Blocked_Shot_Rate * 1.5) +        # Blocking shots as a forward\n      (Faceoff_Effectiveness * 2) +      # Winning defensive zone faceoffs\n      (Penalty_Discipline * 1.5) +       # Staying out of the box\n      (Hits * 0.05) +                    # Physical play\n      (TOI / max(TOI, na.rm = TRUE) * 1.5)  # Coaches trust (ice time)\n    )\n  ) %>%\n  # Scale the score for easier interpretation\n  mutate(Selke_Score = Selke_Score / max(Selke_Score, na.rm = TRUE) * 100)\nhead(forwards)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    X           Player Team Position GP       TOI Goals Total.Assists\n1  41 Kirill Marchenko  CBJ        R 57 1071.6167    24            36\n2 145   Wyatt Johnston  DAL        C 60 1147.8833    21            34\n3  93      Marco Rossi  MIN        C 61 1117.2333    21            30\n4 115       JJ Peterka  BUF        R 57 1029.9500    17            30\n5 163     Logan Cooley  UTA        C 54  957.0333    17            30\n6  92   Dylan Holloway  STL        L 62 1031.9833    20            26\n  First.Assists Second.Assists Total.Points   IPP Shots   SH.   ixG iCF iFF\n1            23             13           60 64.52   155 15.48 17.56 323 226\n2            23             11           55 67.90   163 12.88 27.08 311 239\n3            17             13           51 69.86   102 20.59 15.52 198 155\n4            14             16           47 55.29   129 13.18 14.74 294 207\n5            15             15           47 67.14   115 14.78 12.16 219 164\n6            13             13           46 71.88   145 13.79 14.81 276 197\n  iSCF iHDCF Rush.Attempts Rebounds.Created PIM Total.Penalties Minor Major\n1  147    48             9               35  14               7     7     0\n2  225   116             4               35  12               6     6     0\n3  136    76             3               26  24              12    12     0\n4  131    43            12               20  24               8     7     0\n5  106    40             3               14  30              15    15     0\n6  139    57            10               24  10               5     5     0\n  Misconduct Penalties.Drawn Giveaways Takeaways Hits Hits.Taken Shots.Blocked\n1          0              13        65        29   43         67            29\n2          0              10        36        25   32         72            30\n3          0              16        42        14   42         49            28\n4          1              11        58        14   27         57             7\n5          0              13        48        20   40         94            24\n6          0               8        59        32  133         75            39\n  Faceoffs.Won Faceoffs.Lost Faceoffs.. Takeaway_Ratio Blocked_Shot_Rate\n1           11            24      31.43      0.3085106         1.6237149\n2          337           343      49.56      0.4098361         1.5681036\n3          349           388      47.35      0.2500000         1.5037145\n4            2             4      33.33      0.1944444         0.4077868\n5          241           298      44.71      0.2941176         1.5046498\n6           59            80      42.45      0.3516484         2.2674785\n  Faceoff_Effectiveness Penalty_Discipline Selke_Score\n1             0.3142857          0.2161376    49.79191\n2             0.4955882          0.3727586    51.83975\n3             0.4735414         -0.2888982    44.91144\n4             0.3333333         -0.3981261    24.94876\n5             0.4471243         -0.8808122    37.55984\n6             0.4244604          0.4185953    88.83601\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# View the top Selke candidates\ntop_selke_candidates <- forwards %>%\n  arrange(desc(Selke_Score)) %>%\n  select(Player, Team, Position, GP, Selke_Score) %>%\n  head(10)\n\ntop_selke_candidates <- top_selke_candidates %>%\n  mutate(\n    Expected_Selke = mean(Selke_Score),  # You can define your own expected value\n    Selke_Deviation = Selke_Score - Expected_Selke\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create a diverging bar chart\nggplot(top_selke_candidates, aes(x = reorder(Player, Selke_Score), y = Selke_Deviation, fill = Selke_Deviation > 0)) +\n  geom_bar(stat = 'identity') +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"black\") +\n  scale_fill_manual(values = c(\"firebrick\", \"steelblue\"), \n                    labels = c(\"Below Expected\", \"Above Expected\"),\n                    name = \"\") +\n  labs(\n    title = 'Top Selke Candidates - Deviation from Expected Selke Score',\n    x = 'Player', \n    y = 'Deviation from Expected Selke Score'\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    panel.grid.major.y = element_line(color = \"gray90\"),\n    panel.grid.minor = element_blank(),\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n\n## Lady Byng Memorial Trophy Consideration: Identifying the Most Sportsmanlike Player\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSportsman <- read.csv(\"SkaterIndividualstats.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(Sportsman)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"X\"                \"Player\"           \"Team\"             \"Position\"        \n [5] \"GP\"               \"TOI\"              \"Goals\"            \"Total.Assists\"   \n [9] \"First.Assists\"    \"Second.Assists\"   \"Total.Points\"     \"IPP\"             \n[13] \"Shots\"            \"SH.\"              \"ixG\"              \"iCF\"             \n[17] \"iFF\"              \"iSCF\"             \"iHDCF\"            \"Rush.Attempts\"   \n[21] \"Rebounds.Created\" \"PIM\"              \"Total.Penalties\"  \"Minor\"           \n[25] \"Major\"            \"Misconduct\"       \"Penalties.Drawn\"  \"Giveaways\"       \n[29] \"Takeaways\"        \"Hits\"             \"Hits.Taken\"       \"Shots.Blocked\"   \n[33] \"Faceoffs.Won\"     \"Faceoffs.Lost\"    \"Faceoffs..\"      \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Compute key metrics\nSportsman <- Sportsman %>%\n  mutate(\n    PIM_Ratio = PIM / GP,  # Penalty minutes per game\n    PIM_Ratio = ifelse(is.na(PIM_Ratio), 0, PIM_Ratio),  # Replace NA with 0\n    PIM_Ratio = ifelse(PIM_Ratio > 10, 10, PIM_Ratio),  # Cap at 10\n    PIM_Ratio = PIM_Ratio / 10,  # Scale to 0-1\n    PIM_Ratio = 1 - PIM_Ratio,  # Reverse scale\n    PIM_Ratio = PIM_Ratio * 100  # Scale to 0-100\n  )\n\nSportsman <- Sportsman %>%\n  filter(GP >= 50) %>%\n  mutate(\n    Sportsman_Score = (\n      (PIM_Ratio * 2) +  # Low penalty minutes\n      (Hits * 0.5) +     # Physical play\n      (Giveaways * 0.5)  # Few giveaways\n    )\n  )\n\ntop_sportsman <- Sportsman %>%\n  arrange(desc(Sportsman_Score)) %>%\n  head(10)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Create a unique visualization\nggplot(top_sportsman, aes(x = reorder(Player, -Sportsman_Score), y = Sportsman_Score, fill = Sportsman_Score)) +\n  geom_bar(stat = 'identity') +\n  labs(title = 'Top 5 Sportsman Candidates - Sportsman Score', x = 'Player', y = 'Sportsman Score') +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}